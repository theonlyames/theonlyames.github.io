<link rel="import" href="../../../bower_components/polymer/polymer-element.html">
<!-- <link rel="import" href="../../../bower_components/flickr-handler/flickr-handler.html"> -->

<link rel="import" href="../style/fragment-style.html">

<dom-module id="portfolio-photography">
  <template>
    <style include="portfolio-style">
      .css-grid {
        display: grid;
        grid-template-columns: repeat(1, 1fr);
        grid-gap: 8px;
        grid-auto-rows: minmax(100px, auto);
      }

      .css-grid-item:first-child, .css-grid-item:nth-child(5n+1), .css-grid-item:last-child {
        grid-column: span 1;
      }

      @media only screen and (min-width: 576px) {

        .css-grid {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          grid-gap: 8px;
          grid-auto-rows: minmax(200px, auto);
        }

        .css-grid-item:first-child, .css-grid-item:nth-child(5n+1), .css-grid-item:last-child {
          grid-column: span 2;
        }
      }

      @media only screen and (min-width: 768px) {

        .css-grid {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          grid-gap: 8px;
          grid-auto-rows: minmax(250px, auto);

        }

        .css-grid-item:first-child, .css-grid-item:nth-child(5n+1), .css-grid-item:last-child {
          grid-column: span 2;
        }

      }

      @media only screen and (min-width: 992px) {
        .css-grid {
          display: grid;
          grid-template-columns: repeat(4, 1fr);
          grid-gap: 8px;
          grid-auto-rows: minmax(350px, auto);

        }

        .css-grid-item:first-child, .css-grid-item:nth-child(5n+1), .css-grid-item:last-child {
          grid-column: span 4;
        }

        .css-grid-item:hover {

        }

      }

      @media only screen and (min-width: 1200px) { }
      paper-dialog {
        width: 80vw;
        height: 80vh;
        background-color: none;
      }

      paper-dialog div {
        width: 100%;
        height: 100%;
      }

      .css-grid2 {
        display: grid;
        /*text-align: center;*/
        grid-gap: 8px;
        /*grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));*/
        /*minmax(1fr, 25%));*/

        /*grid-template-rows: repeat(auto, minmax(150px, 1fr));*/
        /*grid-auto-columns: */
        /*grid-auto-rows: minmax(350px, 1fr);*/
        /*grid-auto-flow: dense;*/
      }

      .css-grid-item2 {
        display: block;
        /*object-fit: scale-down;*/
        width: 100%;
        height: 100%;
        /*overflow: hidden;*/
      }

      .css-grid-item2 iron-image, .css-grid-item2 img {
      }

      .css-grid-item {
        position: relative;
        background-color: white;
        width: 100%;
        height: 100%;
      }

      .css-grid-item * {
       display: inline-block;
     }

     .css-grid-item iron-image {
       height: 100%;
       width: 100%;
     }

     .css-grid-item .overlay {
       position: absolute;
       pointer-events: none;
       height: 100%;
       width:  100%;
       top: 0px;
       left: 0px;
       background-color: none;
     }

     .overlay {
       position: absolute;
       width: 100%;
       height: 100%;
       top: 0;
       bottom: 0;
       left: 0;
       right: 0;
       z-index: 1;
       text-align: center;
       pointer-events: none;
       transition: background-color .15s ease-in;
      }

     .css-grid-item:hover .overlay,
     .css-grid-item:active .overlay,
     .css-grid-item:focus .overlay {
       background-color: rgba(144, 202, 249, .15);
       /*position: absolute;*/
      }




      paper-card {
        display: block;
        padding: 16px;
      }






      paper-button {
        min-height: 48px;
        padding: 0 8px;
        /*--paper-button-ink-color: var(--primary-accent-color);*/
      }

    </style>

    <!-- <paper-button on-click="function(){querySelector('boop').toggle;}">A</paper-button> -->

    <article>
      <h2 class="section-header">Photography</h2>

      <flickr-handler id="flickr"
        key='28c5968283d6f308010058714cbc80fb'
        user='158128259@N08'
        photos="{{flickrPhotos}}"
        per-page='{{numberOfPhotos}}'>
      </flickr-handler>


      <paper-card>
        <div class="card-content">
          <iron-selector class="css-grid2"
                         attr-for-selected="name"
                         selected="{{selected}}"
                         selectable=".css-grid-item2">

            <template is="dom-repeat" items="{{flickrPhotos}}">
                <div class="css-grid-item2" name="{{item}}" >
                  <!-- on-click="_getPhotoAspectRatio" -->
                  <!-- <img src$="[[_getPhotoUrl(item)]]"
                              alt="Flickr image"
                              class=" "
                              name="{{item}}"> -->

                  <iron-image src$="[[_getPhotoUrl(item)]]"
                              sizing='none'
                              alt="Flickr Image"
                              style$="{{_getGridItemSize(item)}}">

                  </iron-image>
                  <!-- <paper-button photo='{{item}}' on-tap="_getPhotoAspectRatio">CLICKY</paper-button> -->
                </div>
              <!-- <div class="css-grid-item" attr="[[item.photo.id]]"  name="{{item}}" on-tap="_showOverlay">
                <iron-image src$="[[_getPhotoUrl(item)]]" sizing='cover' alt="Flickr image"></iron-image>
                <div class="overlay"></div>
              </div> -->
            </template>
          </iron-selector>
        </div>
        <!-- <div class="card-actions"> -->
          <!-- <a href="https://www.flickr.com/people/158128259@N08/"> -->
          <!-- <a href="#">
            <paper-button raised>View More On Flickr</paper-button>
          </a>
        </div> -->
      </paper-card>
    </article>



  </template>

  <script>
    class PortfolioPhotography extends Polymer.Element {
      static get is() { return 'portfolio-photography'; }
      static get properties() {
        return {
          handler: {
            type: Object
          },
          flickrPhotos: {
            type: Array,
            value() {
              return [];
            }
          },
          deletedItem: {
            type: Object,
            value: {}
          },
          selected: {
            type: Object
          },
          selectedPhotoOUrl: {
            type: String,
            computed: '_getPhotoUrl(selected)'
          },
          numberOfPhotos: {
            type: Number,
            value: 10
          }

        };
      }

      _rawrs(){
        this.shadowRoot.querySelector('iron-pages').selectNext();
      }

      _isSelected(selected) {
        if (selected == null || selected == undefined)
        {
          return function(){
            return null;
          };
        }
        else {
          return function(item){
            return (item.id != selected.id);
          };
        }
      }

      ready() {
        super.ready();
        this.handler = this.$.flickr;
        this.handler._loadMore();
      }

      _showOverlay(e) {
        // this.$.boop.toggle();
      }

      _getPhotoUrl(photo) {
        return 'https://farm'
                + photo.farm
                + '.staticflickr.com/'
                + photo.server
                + '/' + photo.id + '_'
                + photo.secret + '_b.jpg';
      }

       _getPhotoSize(photo) {
        let sizes = this.handler._getPhotoSizes(photo);
        return sizes;
      }

      _getGridItemSize(photo) {
        let sizes = this._getPhotoSize(photo);
        console.log(sizes);

        let original = sizes[11];
        let height = original.height;
        let width = original.height;
        //


        // if (height > width) {
        //   style += 'height: 100%;'
        //         +  'width: auto;';
        // }
        // else {
        //   style += 'height:auto;'
        //         +  'width: 100%;'
        // }

        // console.log(style);

        // return style;


      }



    }

    window.customElements.define(PortfolioPhotography.is, PortfolioPhotography);
  </script>
</dom-module>
